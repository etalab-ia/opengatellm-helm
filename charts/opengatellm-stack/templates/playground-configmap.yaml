{{- $coreValues := index .Values "opengatellm-core" }}
{{- if $coreValues.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: opengatellm-stack-playground-config
  labels:
    {{- include "opengatellm-stack.labels" . | nindent 4 }}
    app.kubernetes.io/component: playground
data:
  config.yml: |
    settings:
      app_title: {{ $coreValues.opengatellmCore.structuredConfig.playground.app_title | default "OpenGateLLM" | quote }}
      playground_opengatellm_url: {{ $coreValues.opengatellmCore.structuredConfig.playground.api_url | quote }}
      {{- if $coreValues.opengatellmCore.structuredConfig.playground.default_model }}
      playground_default_model: {{ $coreValues.opengatellmCore.structuredConfig.playground.default_model | quote }}
      {{- end }}
      playground_theme_has_background: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_has_background | default true }}
      playground_theme_accent_color: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_accent_color | default "purple" | quote }}
      playground_theme_appearance: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_appearance | default "light" | quote }}
      playground_theme_gray_color: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_gray_color | default "gray" | quote }}
      playground_theme_panel_background: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_panel_background | default "solid" | quote }}
      playground_theme_radius: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_radius | default "medium" | quote }}
      playground_theme_scaling: {{ $coreValues.opengatellmCore.structuredConfig.playground.theme_scaling | default "100%" | quote }}
      encryption_key: {{ $coreValues.opengatellmCore.structuredConfig.playground.encryption_key | default "changeme" | quote }}
      session_secret_key: {{ $coreValues.opengatellmCore.structuredConfig.playground.session_secret_key | default "changeme" | quote }}
      proconnect_enabled: {{ $coreValues.opengatellmCore.structuredConfig.playground.proconnect_enabled | default false }}
    dependencies:
      {{- if $coreValues.opengatellmCore.structuredConfig.dependencies.postgres }}
      postgres:
        {{- toYaml $coreValues.opengatellmCore.structuredConfig.dependencies.postgres | nindent 8 }}
      {{- end }}
      {{- if $coreValues.opengatellmCore.structuredConfig.dependencies.redis }}
      redis:
        {{- toYaml $coreValues.opengatellmCore.structuredConfig.dependencies.redis | nindent 8 }}
      {{- end }}
{{- end }}
